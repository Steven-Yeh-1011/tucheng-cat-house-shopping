# 土城貓舍購物網 - 完整技術架構規格

## 📋 專案概述
- **專案名稱**: 土城貓舍購物網
- **類型**: 電商網站 (Mobile-First)
- **管理員帳號**: cat750417@gmail.com / Bowbow520
- **目標**: 貓咪用品線上購物平台

## 🏗️ 技術架構

### 前端架構 (React + TypeScript)
```
Port: 3011
技術棧:
├── React 18 + TypeScript
├── Styled Components (樣式管理)
├── React Router DOM (路由)
├── Axios (HTTP 請求)
├── React Hook Form + Yup (表單驗證)
├── React Query (狀態管理)
└── Create React App (建構工具)

依賴套件:
├── react@^18.2.0
├── react-dom@^18.2.0
├── react-router-dom@^6.8.0
├── styled-components@^5.3.6
├── axios@^1.3.0
├── react-hook-form@^7.43.0
├── yup@^1.0.0
├── @tanstack/react-query@^4.24.0
└── typescript@^4.9.0
```

### 後端架構 (Node.js + Express + TypeScript)
```
Port: 8011
技術棧:
├── Node.js + Express
├── TypeScript
├── PostgreSQL (資料庫)
├── JWT (認證)
├── bcryptjs (密碼加密)
├── Joi (資料驗證)
├── Morgan (日誌)
├── CORS (跨域)
├── Helmet (安全性)
└── Nodemon (開發)

依賴套件:
├── express@^4.18.0
├── typescript@^5.0.0
├── pg@^8.8.0
├── jsonwebtoken@^9.0.0
├── bcryptjs@^2.4.3
├── joi@^17.7.0
├── morgan@^1.10.0
├── cors@^2.8.5
├── helmet@^6.0.0
├── dotenv@^16.0.0
├── nodemon@^2.0.20
├── ts-node@^10.9.0
└── @types/* (所有類型定義)
```

### 資料庫架構 (PostgreSQL)
```sql
資料庫: tucheng_cat_store
表格:
├── users (用戶表)
├── categories (商品分類)
├── products (商品表)
├── cart_items (購物車)
├── orders (訂單表)
└── order_items (訂單商品)
```

## 🎨 UI/UX 設計規格

### 設計原則
- **Mobile-First**: 優先手機體驗
- **色彩**: 鮭魚粉 + 深海軍藍 + 淺米黃
- **字體**: 圓潤無襯線字體
- **互動**: 48x48px 最小觸控目標

### 頁面結構
1. **商品頁** (`/`)
   - 頂部導覽列 (Logo + 購物車 + Email)
   - 篩選欄 (貓糧/玩具/保健品)
   - 商品網格 (2列布局)
   - 商品卡片 (圖片60% + 名稱 + 價格 + 加入購物車)

2. **購物車頁** (`/cart`)
   - 商品清單 (Checkbox + 圖片 + 資訊 + 數量控制)
   - 金額匯總 (即時更新)
   - 底部結帳欄 (固定)

3. **結帳頁** (`/checkout`)
   - 進度條 (4步驟)
   - 資訊填寫表單
   - 運送方式選擇 (7-11/蝦皮/宅配)
   - 付款方式選擇
   - 訂單金額匯總

## 🚚 物流系統規格

### 運送選項
1. **7-11 店到店** (+NT$ 70)
   - 縣市/鄉鎮選擇
   - 門市關鍵字搜尋
   - 門市地址顯示

2. **蝦皮店到店** (+NT$ 70)
   - 縣市/鄉鎮選擇
   - 門市關鍵字搜尋
   - 門市地址顯示

3. **宅配到家** (+NT$ 90)
   - 地址輸入表單
   - 收件人資訊

## 🔐 認證系統規格

### 管理員權限
- **帳號**: cat750417@gmail.com
- **密碼**: Bowbow520
- **權限**: 
  - 商品 CRUD
  - 分類管理
  - 訂單管理
  - 網站內容修改

### JWT 認證
- **Token 過期**: 24小時
- **刷新機制**: 自動刷新
- **權限控制**: Role-based (admin/user)

## 📡 API 端點規格

### 認證 API
```
POST /api/auth/register - 註冊
POST /api/auth/login - 登入
```

### 商品 API
```
GET /api/products - 取得所有商品
GET /api/products/:id - 取得單一商品
POST /api/products - 創建商品 (需管理員)
PUT /api/products/:id - 更新商品 (需管理員)
DELETE /api/products/:id - 刪除商品 (需管理員)
```

### 分類 API
```
GET /api/categories - 取得所有分類
POST /api/categories - 創建分類 (需管理員)
PUT /api/categories/:id - 更新分類 (需管理員)
DELETE /api/categories/:id - 刪除分類 (需管理員)
```

### 購物車 API
```
GET /api/cart - 取得購物車
POST /api/cart - 加入商品
PUT /api/cart/:id - 更新數量
DELETE /api/cart/:id - 移除商品
DELETE /api/cart - 清空購物車
```

### 物流 API
```
GET /api/shipping/seven-eleven/stores - 7-11門市
GET /api/shipping/shopee/stores - 蝦皮門市
POST /api/shipping/calculate - 計算運費
GET /api/shipping/cities - 縣市列表
GET /api/shipping/districts - 鄉鎮區列表
```

## 🛠️ 開發環境規格

### 必要工具
- **Node.js**: >= 16.0.0
- **npm**: >= 8.0.0
- **PostgreSQL**: >= 12.0
- **Git**: >= 2.30.0

### 環境變數
```env
# 資料庫
DB_HOST=localhost
DB_PORT=5432
DB_NAME=tucheng_cat_store
DB_USER=postgres
DB_PASSWORD=password

# JWT
JWT_SECRET=your-super-secret-jwt-key

# 伺服器
PORT=8011
FRONTEND_URL=http://localhost:3011
NODE_ENV=development
```

### 啟動指令
```bash
# 後端
cd backend
npm install
npm run dev

# 前端
cd frontend
npm install
npm start
```

## 📦 部署規格

### Docker 配置
- **後端**: Node.js 16 Alpine
- **前端**: Nginx Alpine
- **資料庫**: PostgreSQL 14
- **網路**: Docker Compose

### CI/CD
- **平台**: GitHub Actions
- **測試**: Jest + Supertest
- **部署**: Docker Hub + Render

## 🧪 測試規格

### 測試覆蓋率
- **後端**: >= 80%
- **前端**: >= 70%
- **E2E**: 關鍵流程

### 測試工具
- **單元測試**: Jest
- **整合測試**: Supertest
- **E2E測試**: Playwright
- **類型檢查**: TypeScript

## 📊 效能規格

### 目標指標
- **首頁載入**: < 3秒
- **API 響應**: < 500ms
- **圖片優化**: WebP + 懶加載
- **快取策略**: Redis + CDN

### 監控
- **日誌**: Morgan + Winston
- **錯誤追蹤**: Sentry
- **效能監控**: New Relic

---

## ✅ 檢查清單

### 開發前準備
- [ ] Node.js 環境安裝
- [ ] PostgreSQL 資料庫建立
- [ ] 專案目錄結構建立
- [ ] 依賴套件安裝
- [ ] 環境變數設定

### 開發階段
- [ ] 後端 API 實作
- [ ] 前端 UI 實作
- [ ] 資料庫整合
- [ ] 認證系統
- [ ] 購物車功能
- [ ] 物流系統

### 測試階段
- [ ] 單元測試
- [ ] 整合測試
- [ ] E2E 測試
- [ ] 效能測試
- [ ] 安全性測試

### 部署階段
- [ ] Docker 配置
- [ ] CI/CD 設定
- [ ] 生產環境部署
- [ ] 監控設定
- [ ] 備份策略

